<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/minha-rotina.css">
    <link rel="stylesheet" href="/css/header2.css">
    <link rel="shortcut icon" href="../../Images/favicon.ico" type="image/x-icon">
    <title>Minha Rotina</title>
</head>
<body>
    <script>
      // Limpa respostas do VARK ao acessar a página
      for (let i = 1; i <= 16; i++) {
        localStorage.removeItem('vark_q' + i);
      }
    </script>
    <header>
        <a href="/aluno/a-perfil"><img src="/images/voltar.svg" alt=""></a>
        <p>Minha Rotina</p>
        <div>
          <p><%= user.NOME_USU || 'Aluno' %></p>
          <button class="user-icon" id="userIcon" aria-label="Abrir menu do usuário">
              <img src="/aluno/foto-perfil/<%= user.ID_USUARIO %>?v=<%= timestamp %>" alt="imagem do perfil" style="width: 48px; height: 48px; object-fit: cover; border-radius: 50%; border: 2px solid #ccc;" />
              <div class="user-config" id="userConfig">
                  <ul>
                      <li><a href="/aluno/a-perfil">MENU</a></li>
                      <li><a href="/aluno/a-config">CONFIGURAÇÕES</a></li>
                      <li><a href="/aluno/logout">SAIR</a></li>
                  </ul>
              </div>
          </button>
      </div>
      </header>
    <main>
        <section class="conteudo">
            <section class="calendário">
                <h1 id="mes">Mes</h1>
                <script>
                    function atualizarMes() {
                        const meses = [
                            "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
                            "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
                        ];
                        const mesAtual = new Date().getMonth();
                        document.getElementById("mes").textContent = meses[mesAtual];
                    }
                    window.onload = atualizarMes;
                </script>
                <section class="tabela">
                    <table>
                        <thead>
                            <tr>
                                <th>dom</th>
                                <th>seg</th>
                                <th>ter</th>
                                <th>qua</th>
                                <th>qui</th>
                                <th>sex</th>
                                <th>sáb</th>
                            </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>9</td>
                            <td>10</td>
                            <td>11</td>
                            <td>12</td>
                            <td>13</td>
                            <td>14</td>
                        </tr>
                        <tr>
                            <td>15</td>
                            <td>16</td>
                            <td>17</td>
                            <td>18</td>
                            <td>19</td>
                            <td>20</td>
                            <td>21</td>
                        </tr>
                        <tr>
                            <td>22</td>
                            <td>23</td>
                            <td>24</td>
                            <td>25</td>
                            <td>26</td>
                            <td>27</td>
                            <td>28</td>
                        </tr>
                        <tr>
                            <td>29</td>
                            <td>30</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        </tbody>
                    </table>
                </section>
                
            </section>

            <section class="line" id="secao1"></section>
            
            <section class="start">
                <h3>MEUS MÉTODOS</h3>
                <button id="start">Começar Agora!</button>
<script>
  document.getElementById('start').onclick = async function(e) {
    e.preventDefault();
    try {
      const resp = await fetch('/aluno/vark/respondido', { headers: { 'Accept': 'application/json' } });
      const data = await resp.json();
      if (data && data.respondido) {
        window.location.href = '/aluno/a-minha-rotina-2';
      } else {
        window.location.href = '/aluno/quest1_vark';
      }
    } catch (err) {
      window.location.href = '/aluno/quest1_vark';
    }
  };
</script>
                
                <p id="p-start">Faça um teste e desbloqueia as técnicas de estudo que mais combinam com você!</p>
                
            </section>
        </section>
    </main>
    <!-- não tem footer -->
    <script src="/js/icon-menu.js"></script>
</body>
</html>